(this["webpackJsonpmy-bakup-cloud"]=this["webpackJsonpmy-bakup-cloud"]||[]).push([[0],{49:function(e,t,a){e.exports=a(77)},54:function(e,t,a){},77:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),l=a(32),r=a.n(l),o=(a(54),a(55),a(4)),i=a(5),c=a(8),m=a(7),u=a(9),d=a(29),f=a(17),h=(s.a.Component,a(14));a(28);var p=a(0),g=function(e){function t(e){return Object(o.a)(this,t),Object(c.a)(this,Object(m.a)(t).call(this,e))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){p(".login-btn").on("click",(function(){h.auth().signInWithEmailAndPassword(p("#email").val(),p("#password").val()).catch((function(e){e.code,e.message;window.location.pathname="/gallery"}))}))}},{key:"render",value:function(){return s.a.createElement("div",{className:"login-content"},s.a.createElement("label",{htmlFor:"email"},"Email"),s.a.createElement("input",{className:"form-control",type:"text",id:"email",placeholder:"Enter Email Address"}),s.a.createElement("label",{htmlFor:"password"},"Password"),s.a.createElement("input",{className:"form-control",type:"password",id:"password",placeholder:"Enter Password"}),s.a.createElement("button",{className:"btn login-btn"},"Sign In"))}}]),t}(s.a.Component),b=function(e){function t(e){return Object(o.a)(this,t),Object(c.a)(this,Object(m.a)(t).call(this,e))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"container"},s.a.createElement(g,null))}}]),t}(s.a.Component),v=a(24),E=a(19),y=a.n(E),N=a(25);a(31),a(41),a(28);var I=a(0),w=(s.a.Component,a(42)),k=a(33),L=a.n(k),O=a(26);a(31),a(41),a(28);var P=a(0),j=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).viewImage=function(e){var t=P(e.target).attr("id");return s.a.createElement(w.PhotoSwipe,{isOpen:a.isOpen=!0,items:a.imgData,options:{index:parseInt(t),h:3e3,w:3e3},onClose:a.handleClose()})},a.handleClose=function(){a.isOpen=!1},a.loadList=function(){P("img").remove();var e=(a.currentPage-1)*a.numberPerPage,t=e+a.numberPerPage;a.modifiedListData=a.state.thumbs.slice(e,t),a.slicedFullSizeImages=a.state.fullSizeImages.slice(e,t),a.modifiedListData.map((function(e,t){e.getDownloadURL().then((function(n){e.getMetadata().then((function(s){a.imgData.push({index:t,src:{fileName:e.name,thumbnail:n,fileType:s.contentType}})}))}))})),a.getFullSizeImages(),a.drawList()},a.getFullSizeImages=function(){a.slicedFullSizeImages.map((function(e,t){e.getMetadata().then((function(t){e.getDownloadURL().then((function(n){a.fullSizeImageList.push({fileName:e.name,fileType:t.contentType,src:n})}))}))}))},a.showImage=function(e){var t=P(e.target).attr("id").split("_512x512").join("");a.fullSizeImageList.forEach((function(e){e.fileName===t&&window.open(e.src)}))},a.drawList=function(){a.state.thumbs.length?(a.setState({hasLoaded:!0}),a.check()):a.setState({noImages:!0})},a.state={imageRef:h.storage().ref("".concat(e.location.state.storagePath,"/")),thumbRef:h.storage().ref("".concat(e.location.state.storagePath,"/thumbs")),originalListData:[],hasLoaded:!1,noImages:!1,showImage:!1},a.modifiedListData=[],a.newImagesList=[],a.numberPerPage=50,a.currentPage=1,a.numberOfPages=0,a.imgData=[],a.isOpen=!1,a.imgsForSwipe=[],a.fullSizeImageList=[],a.fullSizeIMGs=[],a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){this.addItemsToArray()}},{key:"componentDidMount",value:function(){var e=this;this.loadImages=setInterval((function(){e.loadList()}),2e3),P("#add-photo").on("click",(function(){P(".new-photo-input").focus().trigger("click"),P(".new-photo-input").on("change",(function(t){for(var a=0;a<t.target.files.length;a++)e.newImagesList.push(t.target.files[a]),e.uploadPhoto(t.target.files[a],{contentType:t.target.files[a].type,name:t.target.files[a].name,size:t.target.files[a].size,updated:t.target.files[a].lastModified})}))})),P(".next").on("click",(function(t){e.currentPage+=1,e.loadList()})),P(".prev").on("click",(function(t){e.currentPage=-1,e.loadList()}))}},{key:"uploadPhoto",value:function(e,t){var a=this.state.imageRef.child(e.name).put(e,t);a.on(h.storage.TaskEvent.STATE_CHANGED,(function(e){var t=e.bytesTransferred/e.totalBytes*100;P(".progress-bar").css({display:"flex"}),P(".progress-bar").width(Math.round(t)+"%"),P(".progress-bar").text(Math.round(t)+"%")}),(function(e){e.code}),(function(){a.snapshot.ref.getDownloadURL().then((function(e){P(".progress-bar").css({display:"none"})}))}))}},{key:"addItemsToArray",value:function(){var e=Object(N.a)(y.a.mark((function e(){var t,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state.imageRef.listAll();case 2:return t=e.sent,e.next=5,this.state.thumbRef.listAll();case 5:a=e.sent,this.setState({thumbs:a.items,fullSizeImages:t.items}),this.numberOfPages=this.getNumberOfPages();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getNumberOfPages",value:function(){return Math.ceil(this.state.thumbs.length/this.numberPerPage)}},{key:"check",value:function(){P(".next").attr("disabled",this.currentPage==this.numberOfPages),P(".prev").attr("disabled",1==this.currentPage),P(".first").attr("disabled",1==this.currentPage),P(".last").attr("disabled",this.currentPage==this.numberOfPages)}},{key:"noImages",value:function(){return P(".load-spin").css({display:"none"}),P(".loading-text").text(""),clearInterval(this.loadImages),0===this.imgData.length?s.a.createElement("p",null,"No Images Were Found!"):""}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("section",{className:"top-section"},s.a.createElement("div",{className:"options"},s.a.createElement("p",{className:"folder-name"},this.props.location.state.folderName),s.a.createElement("a",{className:"home-link",href:"/"},"Home"),s.a.createElement("button",{className:"btn btn-sm",id:"add-photo"},"Add more photo's")),s.a.createElement("input",{type:"file",name:"file",accept:"image/*, video/*",id:"add-photo",className:"new-photo-input",style:{display:"none"},multiple:!0})),s.a.createElement("div",{className:"gal-content"},s.a.createElement("div",{className:"progress"},s.a.createElement("div",{className:"progress-bar",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100",style:{display:"none"}})),s.a.createElement("section",{className:"image-content"},s.a.createElement("div",{className:"col"},s.a.createElement("div",{className:"spinner-border text-info load-spin",role:"status"},s.a.createElement("span",{className:"sr-only"},"Loading...")),s.a.createElement("p",{className:"loading-text"},"Loading..."),this.state.hasLoaded?this.imgData.map((function(t,a){return P(".load-spin").css({display:"none"}),P(".loading-text").text(""),clearInterval(e.loadImages),s.a.createElement(L.a,{height:5},t.src.fileType.includes("video")?s.a.createElement("a",{href:t.src},s.a.createElement(O.a,{className:"folder-icon img-thumbnail",color:"#5f9ea0"})):s.a.createElement("img",{className:"img image-item img-thumbnail",key:a,id:t.src.fileName,onClick:e.showImage,src:t.src.thumbnail}))})):this.state.noImages?this.noImages():null,this.fullSizeImageList.map((function(e,t){return e.fileType.includes("video")?s.a.createElement(L.a,null,s.a.createElement("a",{href:e.src},s.a.createElement(O.a,{className:"folder-icon img-thumbnail",color:"#5f9ea0"}))):null}))),s.a.createElement("div",{className:"controls"},s.a.createElement("button",{className:"btn btn-sm prev"},"Prev"),s.a.createElement("button",{className:"btn btn-sm next",value:"next"},"Next")))))}}]),t}(s.a.Component);a(31),a(76);var x=a(0),C=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).createFolder=function(){var e=x("#main-folder-name").val();a.state.databaseRef.push().set({storagePath:e.includes(" ")?e.split(" ").join("-").toLowerCase():e.toLowerCase(),folderName:x("#main-folder-name").val()},(function(e){})).then((function(){x(".modal").modal("hide"),a.loadList()}))},a.getFolders=function(){a.state.databaseRef.on("child_added",(function(e){e.val().ownerID===a.state.userID&&a.finalFolderList.push(e)}))},a.loadList=function(){a.setState({folderList:a.finalFolderList})},a.state={userID:e.currentUser.uid,databaseRef:v.database().ref("folders/"),folderList:[],folderName:"",storageFolderName:""},a.finalFolderList=[],a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){this.getFolders()}},{key:"componentDidMount",value:function(){var e=this;this.loadFolders=setInterval((function(){e.loadList()}),1500)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("section",{className:"top-section"},s.a.createElement("button",{className:"btn btn-sm create-folder",onClick:function(){return x(".modal").modal("show")}},"Create a folder")),s.a.createElement("div",{className:"folder-layout"},s.a.createElement("div",{class:"d-flex justify-content-center pt-3"},s.a.createElement("div",{class:"spinner-border load-spin",role:"status"},s.a.createElement("span",{class:"sr-only"},"Loading..."))),s.a.createElement("p",{className:"loading-text"},"Loading Folders..."),s.a.createElement("div",{className:"folders"},this.state.folderList.length?this.state.folderList.map((function(t,a){return clearInterval(e.loadFolders),x(".load-spin").css({display:"none"}),x(".loading-text").text(""),console.log(e.state.userID),s.a.createElement(d.b,{className:"f-items",key:a,to:{pathname:"/gallery",state:{storagePath:t.val().storagePath,folderName:t.val().folderName,loadImages:!0}}},s.a.createElement("p",{className:"folder-item"},s.a.createElement(O.b,{className:"folder-icon",color:"#5f9ea0"}),t.val().folderName))})):clearInterval(this.loadFolders)),s.a.createElement("div",{className:"modal",tabIndex:"-1",role:"dialog"},s.a.createElement("div",{className:"modal-dialog",role:"document"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title"},"Create a new folder"),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("div",{className:"modal-body"},s.a.createElement("label",{htmlFor:"main-folder-name"},"Folder Name"),s.a.createElement("input",{className:"form-control",type:"text",id:"main-folder-name"})),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close"),s.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.createFolder},"Create Folder")))))))}}]),t}(s.a.Component);s.a.lazy((function(){return a.e(3).then(a.bind(null,78))}));a(28);var S=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this))).state={user:null};return v.initializeApp({apiKey:"AIzaSyBCPuCUA_bDwh3uwRDZwawIB7CE_7LiT9k",authDomain:"mybakupcloud.firebaseapp.com",databaseURL:"https://mybakupcloud.firebaseio.com",projectId:"mybakupcloud",storageBucket:"mybakupcloud.appspot.com",messagingSenderId:"94960637608",appId:"1:94960637608:web:cb47ef0d0cc01c0d1c149d"}),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){var e=this;v.auth().onAuthStateChanged((function(t){t?e.setState({user:t}):e.setState({user:null})}))}},{key:"render",value:function(){var e=this;return s.a.createElement(d.a,null,s.a.createElement(f.a,{exact:!0,path:"/",render:function(){return null!=e.state.user?s.a.createElement(C,{currentUser:e.state.user}):s.a.createElement(b,null)}}),s.a.createElement(f.a,{exact:!1,path:"/:handle",render:function(e){return s.a.createElement(j,e)}}))}}]),t}(s.a.Component);r.a.render(s.a.createElement(S,null),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.93bc72df.chunk.js.map